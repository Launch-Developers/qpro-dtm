<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Action</title>

  <link rel="stylesheet" href="//assets.adobedtm.com/activation/reactor/coralui/3.16.0/css/coral.css">
  <link rel="stylesheet" href="../global.css">
  <script>
    window.Coral = window.Coral || {};
    Coral.options = { typeKitId: 'buj6cmr'};
  </script>

  <script src="//assets.adobedtm.com/activation/reactor/coralui/3.16.0/js/libs/jquery.js"></script>
  <script src="//assets.adobedtm.com/activation/reactor/coralui/3.16.0/js/coral.js"></script>
  <script src="https://assets.adobedtm.com/activation/reactor/extensionbridge/extensionbridge.min.js"></script>
  <style type="text/css">
	  .form-label {
		  padding: 10px 0px 10px 0px;
	  }
  </style>
</head>
<body class="coral--light">
  <form>
    <div class="form-label">
      <label>
        <span class="u-label">Survey ID</span>
	<span>
            <input is="coral-textfield" class="coral-Textfield" id="surveyID" class="coral-Form-field">
        </span>
      </label>
    </div>

    <div class="form-label">
      <label>
        <span class="label">Variable 1</span>
        <input is="coral-textfield" id="variable1" class="coral-Form-field"/>
        <button class="coral-Button coral-Button--minimal coral-Button--medium" onclick="window.extensionBridge.openDataElementSelector(function(data) {
            document.getElementById('variable1').value = JSON.stringify(data);
            console.log('test '+JSON.stringify(data));
        });">
          <span class="coral-Icon coral-Icon--sizeS coral-Icon--data" role="img"></span>
          <span class="coral-Button-label"></span></button>
      </label>
    </div>
  </form>

  <script>

//    window.extensionBridge.register({
//      init: function(info) {
//        // Populate view with info.settings which will exist if the user is editing something
//        // that was previously saved.
//        if (info.settings) {
//          document.getElementById('name').value = info.settings.name;
//        }
//      },
//      validate: function() {
//        // Return whether the view is valid.
//        return document.getElementById('name').value.length > 0;
//      },
//      getSettings: function() {
//        // Return user-provided settings.
//        return {
//          name: document.getElementById('name').value
//        };
//      }
//    });
    
    
    window.extensionBridge.register({
      init: function(info) {
        document.getElementById('surveyID').value = (info.settings && info.settings.surveyID) || '';
        if(info.settings && info.settings.surveyID){
            document.getElementById('surveyID').value = info.settings.surveyID;
        }
        if(info.settings && info.settings.custom1El){
            document.getElementById('variable1').value = info.settings.custom1El;
        }       
      },

      getSettings: function() {
        return {
         surveyID: Number(document.getElementById('surveyID').value),
         custom1El: document.getElementById('variable1').value,
        };
      },

      validate: function() {
        return true;
      },
      openDataElementSelector: function () {

      }
    });
  </script>
</body>
</html>
